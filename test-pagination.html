<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Pagination - Sessions Management</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .container {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .button {
        background: #007bff;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
        margin: 5px;
      }
      .button:hover {
        background: #0056b3;
      }
      .button:disabled {
        background: #ccc;
        cursor: not-allowed;
      }
      .success {
        color: #28a745;
        font-weight: bold;
      }
      .error {
        color: #dc3545;
        font-weight: bold;
      }
      .info {
        color: #17a2b8;
      }
      .log {
        background: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        padding: 10px;
        margin: 10px 0;
        max-height: 300px;
        overflow-y: auto;
        font-family: monospace;
        font-size: 12px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üß™ Test Pagination - Sessions Management</h1>
      <p>Tool n√†y s·∫Ω t·∫°o nhi·ªÅu phi√™n test ƒë·ªÉ ki·ªÉm tra t√≠nh nƒÉng ph√¢n trang.</p>

      <div>
        <button class="button" onclick="checkBackend()">
          1. Ki·ªÉm tra Backend
        </button>
        <button class="button" onclick="getConferences()">
          2. L·∫•y danh s√°ch h·ªôi ngh·ªã
        </button>
        <button class="button" onclick="createTestSessions()">
          3. T·∫°o phi√™n test
        </button>
        <button class="button" onclick="checkSessions()">
          4. Ki·ªÉm tra phi√™n
        </button>
        <button class="button" onclick="clearLog()">X√≥a log</button>
      </div>

      <div id="log" class="log"></div>

      <div id="result"></div>
    </div>

    <script>
      const API_BASE = "http://localhost:3001/api";

      function log(message, type = "info") {
        const logDiv = document.getElementById("log");
        const timestamp = new Date().toLocaleTimeString();
        const className =
          type === "error" ? "error" : type === "success" ? "success" : "info";
        logDiv.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
        logDiv.scrollTop = logDiv.scrollHeight;
      }

      function clearLog() {
        document.getElementById("log").innerHTML = "";
      }

      async function checkBackend() {
        try {
          log("üîç ƒêang ki·ªÉm tra backend...");
          const response = await fetch(`${API_BASE}/health`);
          if (response.ok) {
            log("‚úÖ Backend ƒëang ch·∫°y b√¨nh th∆∞·ªùng", "success");
          } else {
            log("‚ùå Backend kh√¥ng ph·∫£n h·ªìi ƒë√∫ng", "error");
          }
        } catch (error) {
          log(`‚ùå Kh√¥ng th·ªÉ k·∫øt n·ªëi backend: ${error.message}`, "error");
        }
      }

      async function getConferences() {
        try {
          log("üìã ƒêang l·∫•y danh s√°ch h·ªôi ngh·ªã...");
          const response = await fetch(`${API_BASE}/conferences`);
          const data = await response.json();

          if (data.data && data.data.length > 0) {
            log(`‚úÖ T√¨m th·∫•y ${data.data.length} h·ªôi ngh·ªã`, "success");
            data.data.forEach((conf) => {
              log(`   - ${conf.name} (ID: ${conf.id})`);
            });
            window.conferenceId = data.data[0].id;
            log(`üìå S·∫Ω s·ª≠ d·ª•ng h·ªôi ngh·ªã: ${data.data[0].name}`, "success");
          } else {
            log("‚ùå Kh√¥ng t√¨m th·∫•y h·ªôi ngh·ªã n√†o", "error");
          }
        } catch (error) {
          log(`‚ùå L·ªói l·∫•y h·ªôi ngh·ªã: ${error.message}`, "error");
        }
      }

      const testSessions = [
        {
          title: "Phi√™n 1 - C√¥ng ngh·ªá AI",
          description: "Th·∫£o lu·∫≠n v·ªÅ tr√≠ tu·ªá nh√¢n t·∫°o trong doanh nghi·ªáp",
          speaker: "Nguy·ªÖn VƒÉn A",
          speakerEmail: "nguyenvana@example.com",
          startTime: "2024-12-20T09:00:00.000Z",
          endTime: "2024-12-20T10:30:00.000Z",
          room: "Ph√≤ng A101",
          track: "AI/ML",
          capacity: 50,
          tags: ["AI", "Machine Learning", "Business"],
        },
        {
          title: "Phi√™n 2 - Blockchain",
          description: "·ª®ng d·ª•ng blockchain trong t√†i ch√≠nh",
          speaker: "Tr·∫ßn Th·ªã B",
          speakerEmail: "tranthib@example.com",
          startTime: "2024-12-20T11:00:00.000Z",
          endTime: "2024-12-20T12:30:00.000Z",
          room: "Ph√≤ng A102",
          track: "Blockchain",
          capacity: 40,
          tags: ["Blockchain", "Finance", "Cryptocurrency"],
        },
        {
          title: "Phi√™n 3 - Cloud Computing",
          description: "D·ªãch v·ª• ƒë√°m m√¢y v√† microservices",
          speaker: "L√™ VƒÉn C",
          speakerEmail: "levanc@example.com",
          startTime: "2024-12-20T14:00:00.000Z",
          endTime: "2024-12-20T15:30:00.000Z",
          room: "Ph√≤ng A103",
          track: "Cloud",
          capacity: 60,
          tags: ["Cloud", "Microservices", "DevOps"],
        },
        {
          title: "Phi√™n 4 - Mobile Development",
          description: "Ph√°t tri·ªÉn ·ª©ng d·ª•ng di ƒë·ªông cross-platform",
          speaker: "Ph·∫°m Th·ªã D",
          speakerEmail: "phamthid@example.com",
          startTime: "2024-12-21T09:00:00.000Z",
          endTime: "2024-12-21T10:30:00.000Z",
          room: "Ph√≤ng B101",
          track: "Mobile",
          capacity: 45,
          tags: ["Mobile", "React Native", "Flutter"],
        },
        {
          title: "Phi√™n 5 - Data Science",
          description: "Ph√¢n t√≠ch d·ªØ li·ªáu l·ªõn v√† machine learning",
          speaker: "Ho√†ng VƒÉn E",
          speakerEmail: "hoangvane@example.com",
          startTime: "2024-12-21T11:00:00.000Z",
          endTime: "2024-12-21T12:30:00.000Z",
          room: "Ph√≤ng B102",
          track: "Data Science",
          capacity: 55,
          tags: ["Data Science", "Big Data", "Analytics"],
        },
        {
          title: "Phi√™n 6 - Web Development",
          description: "Xu h∆∞·ªõng ph√°t tri·ªÉn web hi·ªán ƒë·∫°i",
          speaker: "V≈© Th·ªã F",
          speakerEmail: "vuthif@example.com",
          startTime: "2024-12-21T14:00:00.000Z",
          endTime: "2024-12-21T15:30:00.000Z",
          room: "Ph√≤ng B103",
          track: "Web",
          capacity: 50,
          tags: ["Web", "React", "Vue.js"],
        },
        {
          title: "Phi√™n 7 - Cybersecurity",
          description: "B·∫£o m·∫≠t th√¥ng tin v√† an ninh m·∫°ng",
          speaker: "ƒê·∫∑ng VƒÉn G",
          speakerEmail: "dangvang@example.com",
          startTime: "2024-12-22T09:00:00.000Z",
          endTime: "2024-12-22T10:30:00.000Z",
          room: "Ph√≤ng C101",
          track: "Security",
          capacity: 35,
          tags: ["Security", "Cybersecurity", "Privacy"],
        },
        {
          title: "Phi√™n 8 - IoT",
          description: "Internet of Things v√† smart cities",
          speaker: "B√πi Th·ªã H",
          speakerEmail: "buithih@example.com",
          startTime: "2024-12-22T11:00:00.000Z",
          endTime: "2024-12-22T12:30:00.000Z",
          room: "Ph√≤ng C102",
          track: "IoT",
          capacity: 40,
          tags: ["IoT", "Smart Cities", "Sensors"],
        },
        {
          title: "Phi√™n 9 - DevOps",
          description: "DevOps v√† CI/CD pipeline",
          speaker: "Ng√¥ VƒÉn I",
          speakerEmail: "ngovani@example.com",
          startTime: "2024-12-22T14:00:00.000Z",
          endTime: "2024-12-22T15:30:00.000Z",
          room: "Ph√≤ng C103",
          track: "DevOps",
          capacity: 45,
          tags: ["DevOps", "CI/CD", "Automation"],
        },
        {
          title: "Phi√™n 10 - UI/UX Design",
          description: "Thi·∫øt k·∫ø giao di·ªán ng∆∞·ªùi d√πng hi·ªán ƒë·∫°i",
          speaker: "L√Ω Th·ªã K",
          speakerEmail: "lythik@example.com",
          startTime: "2024-12-23T09:00:00.000Z",
          endTime: "2024-12-23T10:30:00.000Z",
          room: "Ph√≤ng D101",
          track: "Design",
          capacity: 30,
          tags: ["UI/UX", "Design", "User Experience"],
        },
        {
          title: "Phi√™n 11 - Database",
          description: "Qu·∫£n l√Ω c∆° s·ªü d·ªØ li·ªáu hi·ªán ƒë·∫°i",
          speaker: "ƒêinh VƒÉn L",
          speakerEmail: "dinhvanl@example.com",
          startTime: "2024-12-23T11:00:00.000Z",
          endTime: "2024-12-23T12:30:00.000Z",
          room: "Ph√≤ng D102",
          track: "Database",
          capacity: 50,
          tags: ["Database", "SQL", "NoSQL"],
        },
        {
          title: "Phi√™n 12 - Testing",
          description: "Ki·ªÉm th·ª≠ ph·∫ßn m·ªÅm t·ª± ƒë·ªông",
          speaker: "V√µ Th·ªã M",
          speakerEmail: "vothim@example.com",
          startTime: "2024-12-23T14:00:00.000Z",
          endTime: "2024-12-23T15:30:00.000Z",
          room: "Ph√≤ng D103",
          track: "Testing",
          capacity: 40,
          tags: ["Testing", "Automation", "QA"],
        },
      ];

      async function createTestSessions() {
        if (!window.conferenceId) {
          log("‚ùå Vui l√≤ng l·∫•y danh s√°ch h·ªôi ngh·ªã tr∆∞·ªõc", "error");
          return;
        }

        try {
          log("üöÄ B·∫Øt ƒë·∫ßu t·∫°o phi√™n test...");

          let successCount = 0;
          let errorCount = 0;

          for (let i = 0; i < testSessions.length; i++) {
            const session = testSessions[i];
            try {
              const response = await fetch(`${API_BASE}/sessions`, {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify({
                  conferenceId: window.conferenceId,
                  ...session,
                }),
              });

              if (response.ok) {
                log(`‚úÖ T·∫°o phi√™n ${i + 1}: ${session.title}`, "success");
                successCount++;
              } else {
                const error = await response.text();
                log(`‚ùå L·ªói t·∫°o phi√™n ${i + 1}: ${error}`, "error");
                errorCount++;
              }
            } catch (error) {
              log(`‚ùå L·ªói t·∫°o phi√™n ${i + 1}: ${error.message}`, "error");
              errorCount++;
            }

            // Small delay between requests
            await new Promise((resolve) => setTimeout(resolve, 200));
          }

          log(`üìä K·∫øt qu·∫£:`, "info");
          log(`‚úÖ Th√†nh c√¥ng: ${successCount} phi√™n`, "success");
          log(`‚ùå L·ªói: ${errorCount} phi√™n`, "error");
          log(`üìù T·ªïng c·ªông: ${testSessions.length} phi√™n`, "info");

          if (successCount > 0) {
            log(
              "üéâ Ho√†n th√†nh! B√¢y gi·ªù b·∫°n c√≥ th·ªÉ ki·ªÉm tra ph√¢n trang t·∫°i:",
              "success"
            );
            log("http://localhost:3000/sessions-management", "info");
          }
        } catch (error) {
          log(`‚ùå L·ªói: ${error.message}`, "error");
        }
      }

      async function checkSessions() {
        try {
          log("üìã ƒêang ki·ªÉm tra danh s√°ch phi√™n...");
          const response = await fetch(`${API_BASE}/sessions`);
          const data = await response.json();

          if (data.data && data.data.length > 0) {
            log(`‚úÖ T√¨m th·∫•y ${data.data.length} phi√™n`, "success");
            data.data.forEach((session, index) => {
              log(
                `   ${index + 1}. ${session.name || session.title} (ID: ${
                  session.id
                })`
              );
            });

            if (data.data.length >= 10) {
              log("üéØ C√≥ ƒë·ªß d·ªØ li·ªáu ƒë·ªÉ test ph√¢n trang!", "success");
            } else {
              log(
                `‚ö†Ô∏è C·∫ßn √≠t nh·∫•t 10 phi√™n ƒë·ªÉ test ph√¢n trang (hi·ªán c√≥: ${data.data.length})`,
                "error"
              );
            }
          } else {
            log("‚ùå Kh√¥ng t√¨m th·∫•y phi√™n n√†o", "error");
          }
        } catch (error) {
          log(`‚ùå L·ªói ki·ªÉm tra phi√™n: ${error.message}`, "error");
        }
      }

      // Auto check backend on load
      window.onload = function () {
        checkBackend();
      };
    </script>
  </body>
</html>
