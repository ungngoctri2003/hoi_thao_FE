<!DOCTYPE html>
<html>
  <head>
    <title>Test Rooms Status</title>
  </head>
  <body>
    <h1>Test Rooms Status</h1>
    <div id="output"></div>

    <script>
      async function testRoomsAPI() {
        try {
          console.log("Testing rooms API...");

          const response = await fetch("http://localhost:3001/api/rooms", {
            method: "GET",
            headers: {
              "Content-Type": "application/json",
            },
          });

          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const rooms = await response.json();
          console.log(`Found ${rooms.length} rooms from API:`, rooms);

          let output = `<h2>Found ${rooms.length} rooms from API:</h2>`;
          output +=
            '<table border="1" style="border-collapse: collapse; width: 100%;">';
          output +=
            "<tr><th>ID</th><th>Name</th><th>STATUS (from DB)</th><th>status (mapped)</th></tr>";

          rooms.forEach((room) => {
            console.log(
              `ID: ${room.ID}, Name: ${room.NAME}, STATUS: ${room.STATUS}, status: ${room.status}`
            );
            output += `<tr>
                        <td>${room.ID}</td>
                        <td>${room.NAME}</td>
                        <td>${room.STATUS || "null"}</td>
                        <td>${room.status || "null"}</td>
                    </tr>`;
          });

          output += "</table>";

          // Check status distribution
          const statusCounts = {};
          rooms.forEach((room) => {
            const status = room.STATUS || "null";
            statusCounts[status] = (statusCounts[status] || 0) + 1;
          });

          output += "<h3>STATUS distribution from API:</h3><ul>";
          Object.entries(statusCounts).forEach(([status, count]) => {
            output += `<li>${status}: ${count} rooms</li>`;
          });
          output += "</ul>";

          document.getElementById("output").innerHTML = output;
        } catch (error) {
          console.error("Error testing rooms API:", error);
          document.getElementById(
            "output"
          ).innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
        }
      }

      // Run test when page loads
      testRoomsAPI();
    </script>
  </body>
</html>
