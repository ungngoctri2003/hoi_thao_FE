<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Monthly Chart Test</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .container {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }
      .status {
        padding: 10px;
        margin: 10px 0;
        border-radius: 4px;
        font-weight: bold;
      }
      .success {
        background-color: #d4edda;
        color: #155724;
      }
      .error {
        background-color: #f8d7da;
        color: #721c24;
      }
      .info {
        background-color: #d1ecf1;
        color: #0c5460;
      }
      .warning {
        background-color: #fff3cd;
        color: #856404;
      }
      button {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
        margin: 5px;
      }
      button:hover {
        background-color: #0056b3;
      }
      .log {
        background-color: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        padding: 10px;
        margin: 10px 0;
        max-height: 300px;
        overflow-y: auto;
        font-family: monospace;
        font-size: 12px;
      }
      .chart-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }
      .chart-card {
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 15px;
        background: white;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .chart-card h4 {
        margin: 0 0 10px 0;
        color: #333;
        font-size: 14px;
        font-weight: bold;
      }
      .stat-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        margin: 5px 0;
        border-radius: 4px;
        font-size: 12px;
      }
      .stat-conferences {
        background-color: #e3f2fd;
        color: #1565c0;
      }
      .stat-attendees {
        background-color: #e8f5e8;
        color: #2e7d32;
      }
      .stat-engagement {
        background-color: #f3e5f5;
        color: #7b1fa2;
      }
      .test-data {
        background-color: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        padding: 10px;
        margin: 10px 0;
        font-family: monospace;
        font-size: 12px;
        white-space: pre-wrap;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Monthly Chart Test</h1>
      <p>Test monthly statistics chart formatting and display</p>

      <div id="status" class="status info">Ready to test</div>

      <div>
        <button onclick="testMonthFormatting()">Test Month Formatting</button>
        <button onclick="testChartDisplay()">Test Chart Display</button>
        <button onclick="testAllFormats()">Test All Formats</button>
        <button onclick="clearLogs()">Clear Logs</button>
      </div>

      <div id="logs" class="log"></div>
    </div>

    <div class="container">
      <h2>Test Data</h2>
      <div id="test-data" class="test-data"></div>
    </div>

    <div class="container">
      <h2>Chart Display</h2>
      <div id="chart-display" class="chart-grid"></div>
    </div>

    <script>
      // Helper function to format month display (same as in React component)
      function formatMonthDisplay(monthStr) {
        try {
          // Handle different month formats
          if (!monthStr) return "N/A";

          // If month is in YYYY-MM format, use it directly
          if (/^\d{4}-\d{2}$/.test(monthStr)) {
            const date = new Date(monthStr + "-01");
            return date.toLocaleDateString("vi-VN", {
              year: "numeric",
              month: "long",
            });
          }

          // If month is in MM/YYYY format, convert it
          if (/^\d{1,2}\/\d{4}$/.test(monthStr)) {
            const [month, year] = monthStr.split("/");
            const date = new Date(parseInt(year), parseInt(month) - 1, 1);
            return date.toLocaleDateString("vi-VN", {
              year: "numeric",
              month: "long",
            });
          }

          // If month is just a number (1-12), assume current year
          if (/^\d{1,2}$/.test(monthStr)) {
            const currentYear = new Date().getFullYear();
            const date = new Date(currentYear, parseInt(monthStr) - 1, 1);
            return date.toLocaleDateString("vi-VN", {
              year: "numeric",
              month: "long",
            });
          }

          // Fallback: try to parse as date
          const date = new Date(monthStr);
          if (!isNaN(date.getTime())) {
            return date.toLocaleDateString("vi-VN", {
              year: "numeric",
              month: "long",
            });
          }

          // If all else fails, return the original string
          return monthStr;
        } catch (error) {
          console.warn("Error parsing month:", monthStr, error);
          return monthStr || "N/A";
        }
      }

      // Test data with different month formats
      const testData = [
        {
          month: "2024-01",
          conferences: 5,
          attendees: 150,
          engagement: 85.5,
        },
        {
          month: "02/2024",
          conferences: 8,
          attendees: 240,
          engagement: 92.3,
        },
        {
          month: "3",
          conferences: 12,
          attendees: 380,
          engagement: 78.9,
        },
        {
          month: "April 2024",
          conferences: 15,
          attendees: 450,
          engagement: 88.2,
        },
        {
          month: "2024-05",
          conferences: 18,
          attendees: 520,
          engagement: 91.7,
        },
        {
          month: "6",
          conferences: 22,
          attendees: 680,
          engagement: 86.4,
        },
      ];

      function log(message, type = "info") {
        const timestamp = new Date().toLocaleTimeString();
        const logElement = document.getElementById("logs");
        const logEntry = document.createElement("div");
        logEntry.innerHTML = `[${timestamp}] ${message}`;
        logEntry.style.color =
          type === "error"
            ? "#721c24"
            : type === "success"
            ? "#155724"
            : type === "warning"
            ? "#856404"
            : "#0c5460";
        logElement.appendChild(logEntry);
        logElement.scrollTop = logElement.scrollHeight;
      }

      function updateStatus(message, type = "info") {
        const statusElement = document.getElementById("status");
        statusElement.textContent = message;
        statusElement.className = `status ${type}`;
      }

      function testMonthFormatting() {
        updateStatus("Testing month formatting...", "info");
        log("=== Testing Month Formatting ===");

        testData.forEach((stat, index) => {
          const formatted = formatMonthDisplay(stat.month);
          log(`Month ${index + 1}: "${stat.month}" -> "${formatted}"`, "info");
        });

        log("Month formatting test completed", "success");
        updateStatus("Month formatting test completed", "success");
      }

      function testChartDisplay() {
        updateStatus("Testing chart display...", "info");
        log("=== Testing Chart Display ===");

        const chartContainer = document.getElementById("chart-display");
        chartContainer.innerHTML = "";

        testData.forEach((stat, index) => {
          const card = document.createElement("div");
          card.className = "chart-card";

          const formattedMonth = formatMonthDisplay(stat.month);

          card.innerHTML = `
            <h4>${formattedMonth}</h4>
            <div class="stat-item stat-conferences">
              <span>Hội nghị</span>
              <span>${stat.conferences || 0}</span>
            </div>
            <div class="stat-item stat-attendees">
              <span>Tham dự viên</span>
              <span>${(stat.attendees || 0).toLocaleString()}</span>
            </div>
            <div class="stat-item stat-engagement">
              <span>Tương tác</span>
              <span>${(stat.engagement || 0).toFixed(1)}%</span>
            </div>
          `;

          chartContainer.appendChild(card);
          log(`Created chart card for ${formattedMonth}`, "info");
        });

        log("Chart display test completed", "success");
        updateStatus("Chart display test completed", "success");
      }

      function testAllFormats() {
        updateStatus("Testing all month formats...", "info");
        log("=== Testing All Month Formats ===");

        const formats = [
          "2024-01",
          "02/2024",
          "3",
          "April 2024",
          "2024-05",
          "6",
          "2023-12",
          "1/2023",
          "12",
          "December 2023",
          "2023-01",
          "1",
        ];

        let passed = 0;
        let failed = 0;

        formats.forEach((format, index) => {
          try {
            const formatted = formatMonthDisplay(format);
            log(`Format ${index + 1}: "${format}" -> "${formatted}"`, "info");
            if (formatted && formatted !== "N/A") {
              passed++;
            } else {
              failed++;
              log(`Failed to format: "${format}"`, "error");
            }
          } catch (error) {
            failed++;
            log(`Error formatting "${format}": ${error}`, "error");
          }
        });

        const result = `All formats test completed: ${passed} passed, ${failed} failed`;
        log(result, failed === 0 ? "success" : "error");
        updateStatus(result, failed === 0 ? "success" : "error");
      }

      function clearLogs() {
        document.getElementById("logs").innerHTML = "";
        document.getElementById("chart-display").innerHTML = "";
        updateStatus("Logs cleared", "info");
      }

      function displayTestData() {
        const testDataElement = document.getElementById("test-data");
        testDataElement.textContent = JSON.stringify(testData, null, 2);
      }

      // Initialize
      window.onload = function () {
        log("Monthly Chart Test loaded");
        log("Click buttons to run tests");
        displayTestData();
      };
    </script>
  </body>
</html>
